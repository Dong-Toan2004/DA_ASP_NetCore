@using Application.DataTransferObjects.Product
@model IEnumerable<ProductDto>

@{
	ViewData["Title"] = "Trang chủ";
}

<link rel="stylesheet" href="~/css/home_Index.css" asp-append-version="true" />

<div class="py-3 search-container">
	<form class="search-bar d-flex justify-content-center" role="search">
		<input class="form-control me-2 w-50" type="search" placeholder="Search" aria-label="Search" />
		<button class="btn btn-outline-dark" type="submit">Search</button>
	</form>
</div>

@* Carousel slide *@
<div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3000">
	<div class="carousel-indicators">
		<button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
		<button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
		<button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
		<button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="3" aria-label="Slide 4"></button>
	</div>
	<div class="carousel-inner">
		<div class="carousel-item active">
			<img src="~/img/carousel_slide_1.jpeg" class="d-block w-100 img_Carousel_Slide" alt="carousel slide 1">
			<div class="carousel-caption d-none d-md-block">
				<h5>First slide label</h5>
				<p>Some representative placeholder content for the first slide.</p>
			</div>
		</div>
		<div class="carousel-item">
			<img src="~/img/carousel_slide_2.jpeg" class="d-block w-100 img_Carousel_Slide" alt="carousel slide 2">
			<div class="carousel-caption d-none d-md-block">
				<h5>Second slide label</h5>
				<p>Some representative placeholder content for the second slide.</p>
			</div>
		</div>
		<div class="carousel-item">
			<img src="~/img/carousel_slide_3.jpg" class="d-block w-100 img_Carousel_Slide" alt="carousel slide 3">
			<div class="carousel-caption d-none d-md-block">
				<h5>Third slide label</h5>
				<p>Some representative placeholder content for the third slide.</p>
			</div>
		</div>
		<div class="carousel-item">
			<img src="~/img/carousel_slide_4.jpg" class="d-block w-100 img_Carousel_Slide" alt="carousel slide 4">
			<div class="carousel-caption d-none d-md-block">
				<h5>Third slide label</h5>
				<p>Some representative placeholder content for the third slide.</p>
			</div>
		</div>
	</div>
	<button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
		<span class="carousel-control-prev-icon" aria-hidden="true"></span>
		<span class="visually-hidden">Previous</span>
	</button>
	<button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
		<span class="carousel-control-next-icon" aria-hidden="true"></span>
		<span class="visually-hidden">Next</span>
	</button>
</div>

<div class="container container-home">
	<h1 class="text-center title">Các món được đánh giá cao nhất</h1>
	<p class="text-center">Những món ăn được mọi người yêu thích và đánh giá cao nhất</p>
	<div class="row row-cols-1 row-cols-md-3 g-4" style="margin-top: 60px">
		@foreach (var product in Model)
		{
			
			<div class="col mb-4">
				<div class="card h-100 position-relative">
					<a asp-controller="Product" asp-action="ProductDetail" style="text-decoration:none; color: black">
					<div class="card-img-wrapper position-relative">
						@if (!string.IsNullOrEmpty(product.ImageUrl))
						{
							<img src="@product.ImageUrl" class="card-img-top" alt="@product.Name" style="object-fit:cover; height:300px;">
						}

						@* @if(product.DiscountId != null)
						{
							<div class="discount-badge">
								-@product.Discount.Percentage.ToString("N0")%
								<br />
								(@(product.Price* product.DiscountPercent / 100) ₫)
							</div>
						}*@
					</div>

					<div class="card-body">
						<h5 class="card-title">@product.Name</h5>
						<p class="card-text">@product.Description</p>
					</div>
					<div class="card-footer">
						<span class="text-muted pricecss d-block mt-3">@product.Price.ToString("N0") ₫</span>
					</div>
					</a>
					<button type="button"
							class="add-to-cart-btn"
							onclick="addToCart('@product.Id')">
						<i class="bi bi-cart-plus-fill"></i>
					</button>
				</div>
			</div>
		}
	</div>

	<h1 class="text-center title2">Các món được đặt hàng nhiều nhất</h1>
	<p class="text-center">Các món ăn được mọi người đặt hàng nhiều nhất trong 30 ngày</p>
	<div class="row row-cols-1 row-cols-md-3 g-4" style="margin-top: 60px">
		@foreach (var product in Model)
		{
			<div class="col mb-4">
				<div class="card h-100 position-relative">
					<a asp-action="ProductDetail" style="text-decoration:none; color: black">
					<div class="card-img-wrapper position-relative">
						@if (!string.IsNullOrEmpty(product.ImageUrl))
						{
							<img src="@product.ImageUrl" class="card-img-top" alt="@product.Name" style="object-fit:cover; height:300px;">
						}

						@* @if(product.DiscountId != null)
						{
							<div class="discount-badge">
								-@product.Discount.Percentage.ToString("N0")%
								<br />
								(@(product.Price* product.DiscountPercent / 100) ₫)
							</div>
						}*@
					</div>

					<div class="card-body">
						<h5 class="card-title">@product.Name</h5>
						<p class="card-text">@product.Description</p>
					</div>
					<div class="card-footer">
						<span class="text-muted pricecss d-block mt-3">@product.Price.ToString("N0") ₫</span>
					</div>
					</a>
					<button type="button"
							class="add-to-cart-btn"
							onclick="addToCart('@product.Id')">
						<i class="bi bi-cart-plus-fill"></i>
					</button>
				</div>
			</div>
		}
	</div>

	<h1 class="text-center title2">Các món ăn nhanh</h1>
	<p class="text-center">Các món ăn nhanh phù hợp với mọi lứa tuổi</p>
	<div class="row row-cols-1 row-cols-md-3 g-4" style="margin-top: 60px">
		@foreach (var product in Model)
		{
			<div class="col mb-4">
				<div class="card h-100 position-relative">
					<a asp-action="ProductDetail" style="text-decoration:none; color: black">
					<div class="card-img-wrapper position-relative">
						@if (!string.IsNullOrEmpty(product.ImageUrl))
						{
							<img src="@product.ImageUrl" class="card-img-top" alt="@product.Name" style="object-fit:cover; height:300px;">
						}

						@* @if(product.DiscountId != null)
						{
							<div class="discount-badge">
								-@product.Discount.Percentage.ToString("N0")%
								<br />
								(@(product.Price* product.DiscountPercent / 100) ₫)
							</div>
						}*@
					</div>

					<div class="card-body">
						<h5 class="card-title">@product.Name</h5>
						<p class="card-text">@product.Description</p>
					</div>
					<div class="card-footer">
						<span class="text-muted pricecss d-block mt-3">@product.Price.ToString("N0") ₫</span>
					</div>
					</a>
					<button type="button"
							class="add-to-cart-btn"
							onclick="addToCart('@product.Id')">
						<i class="bi bi-cart-plus-fill"></i>
					</button>
				</div>
			</div>
		}
	</div>

	<section class="hero">
		<div class="hero-contenr">
			<a href="https://www.youtube.com/watch?v=esw7lJlLbhA&t=1044s" class="video-popup">
				<div class="play-button">
					<i class="bi bi-play-circle"></i>
				</div>
			</a>
			<h2>Chúng tôi luôn phục vụ món ăn nóng hổi và thơm ngon</h2>
			<p>Chúng tôi cam kết mang đến cho bạn những món ăn ngon nhất, được chế biến từ nguyên liệu tươi ngon và đảm bảo vệ sinh an toàn thực phẩm.</p>
		</div>
	</section>

	<h1 class="text-center title">Tin tức mới nhất của chúng tôi</h1>
	<p class="text-center">Luân cập nhật những tin tức mới nhất cho mọi người</p>
	<div class="row row-cols-1 row-cols-md-3 g-4" style="margin-top: 60px">
		@foreach (var product in Model)
		{
			<div class="col mb-4">
				<div class="card h-100 position-relative">
					<a asp-controller="Product" asp-action="ProductDetail" style="text-decoration:none; color:black">
					<div class="card-img-wrapper position-relative">
						@if (!string.IsNullOrEmpty(product.ImageUrl))
						{
							<img src="@product.ImageUrl" class="card-img-top" alt="@product.Name" style="object-fit:cover; height:300px;">
						}

						@* @if(product.DiscountId != null)
						{
							<div class="discount-badge">
								-@product.Discount.Percentage.ToString("N0")%
								<br />
								(@(product.Price* product.DiscountPercent / 100) ₫)
							</div>
						}*@
					</div>

					<div class="card-body">
						<h5 class="card-title">@product.Name</h5>
						<p class="card-text">@product.Description</p>
					</div>
					<div class="card-footer">
						<span class="text-muted pricecss d-block mt-3">@product.Price.ToString("N0") ₫</span>
					</div>
					</a>
					<button type="button"
							class="add-to-cart-btn"
							onclick="addToCart('@product.Id')">
						<i class="bi bi-cart-plus-fill"></i>
					</button>
				</div>
			</div>
		}
	</div>

	<div class="message d-flex flex-row justify-content-between align-items-start" style="gap: 40px;">
		<section class="map-section flex-fill" style="margin-top: 50px; margin-bottom: 40px; max-width: 50%;">
			<div style="width:100%; height:500px;">
				<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3734.5869717317933!2d106.0371285!3d20.6049182!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3135c5b7fad6100f%3A0x990c121a90f46cd6!2zTmjDoCBWxINuIEhvw6EgWMOzbSAzIFRow7RuIFRoxrAgTMOidQ!5e0!3m2!1svi!2s!4v1753266962909!5m2!1svi!2s"
						width="100%"
						height="450"
						style="border:0;"
						allowfullscreen=""
						loading="lazy"
						referrerpolicy="no-referrer-when-downgrade">
				</iframe>
			</div>
		</section>

		<div class="message-input flex-fill" style="max-width: 50%;">
			<h1 class="text-center title2">Gửi tin nhắn cho chúng tôi</h1>
			<p class="text-center">Chúng tôi sẽ phản hồi trong vòng 24 giờ</p>
			<form id="contactForm" method="post" action="/Home/SendMessage">
				<div class="mb-3">
					<label for="name" class="form-label">Họ và tên</label>
					<input type="text" class="form-control" id="name" name="name" required />
				</div>
				<div class="mb-3">
					<label for="email" class="form-label">Email</label>
					<input type="email" class="form-control" id="email" name="email" required />
				</div>
				<div class="mb-3">
					<label for="message" class="form-label">Tin nhắn</label>
					<textarea class="form-control" id="message" name="message" rows="4" required></textarea>
				</div>
				<button type="submit" class="btn btn-success">Gửi tin nhắn</button>
			</form>
		</div>
	</div>
</div>

@*  thông báo toast *@
<div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1055;">
	<div id="cartToast" class="toast align-items-center text-bg-success border-0" role="alert">
		<div class="d-flex">
			<div class="toast-body" id="cartToastMessage">
				Thêm vào giỏ hàng thành công
			</div>
			<button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
		</div>
	</div>
</div>

<script>
	function showToast(message, success = true) {
		const toastEl = document.getElementById('cartToast');
		const toastMsg = document.getElementById('cartToastMessage');

		toastMsg.innerText = message;

		toastEl.classList.remove('text-bg-success', 'text-bg-danger');
		toastEl.classList.add(success ? 'text-bg-success' : 'text-bg-danger');

		const toast = new bootstrap.Toast(toastEl, { delay: 2500 });
		toast.show();
	}
</script>

<script src="~/js/home_index.js" asp-append-version="true"></script>
<script src="~/js/cart.js" asp-append-version="true"></script>




